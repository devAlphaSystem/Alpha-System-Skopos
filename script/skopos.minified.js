var _t=Object.defineProperty,Pt=Object.defineProperties;var Rt=Object.getOwnPropertyDescriptors;var lt=Object.getOwnPropertySymbols;var $t=Object.prototype.hasOwnProperty,zt=Object.prototype.propertyIsEnumerable;var ft=(a,c,p)=>c in a?_t(a,c,{enumerable:!0,configurable:!0,writable:!0,value:p}):a[c]=p,E=(a,c)=>{for(var p in c||(c={}))$t.call(c,p)&&ft(a,p,c[p]);if(lt)for(var p of lt(c))zt.call(c,p)&&ft(a,p,c[p]);return a},I=(a,c)=>Pt(a,Rt(c));((a,c,p,y,M)=>{var ct;const V=c.currentScript;if(!V)return;const g=t=>V.getAttribute(t),f={siteId:g("data-site-id")||"",host:(g("data-host")||"").replace(/\/+$/,""),autoTrack:g("data-auto-track")!=="false",trackErrors:g("data-track-errors")!=="false",trackOutbound:g("data-track-outbound")!=="false",trackDownloads:g("data-track-downloads")!=="false",hashMode:g("data-hash-mode")==="true",respectDnt:g("data-respect-dnt")==="true",debug:g("data-debug")==="true",batchInterval:Math.max(1e3,Number.parseInt(g("data-batch-interval"),10)||5e3),maxBatchSize:Math.min(50,Math.max(1,Number.parseInt(g("data-max-batch-size"),10)||10)),sessionTimeout:Math.max(6e4,Number.parseInt(g("data-session-timeout"),10)||18e5)};if(!f.siteId){console.warn("[Skopos] Missing required data-site-id attribute");return}if(!f.host){console.warn("[Skopos] Missing required data-host attribute");return}if(f.respectDnt&&(p.doNotTrack==="1"||a.doNotTrack==="1")){f.debug&&console.log("[Skopos] Do Not Track enabled, analytics disabled"),a.skopos=()=>{};return}const K=`${f.host}/collect`,b="_sk_",J=`${b}sid`,W=`${b}vid`,w=`${b}la`,F=`${b}q`,dt=100,ht=50,G=/\.(pdf|zip|rar|7z|tar|gz|dmg|exe|msi|doc|docx|xls|xlsx|ppt|pptx|csv|mp3|mp4|avi|mov|webm)(?:[?#]|$)/i,Y="sk0p0s_4n4lyt1cs_0bf_k3y_2026",pt=10,S={NAVIGATION:"navigation",CLICK:"click",INPUT:"input",CUSTOM:"custom",CONSOLE:"console",NETWORK:"network"};function gt(t){try{const e=JSON.stringify(t),r=Y.length;let n="";for(let i=0;i<e.length;i++){const o=e.charCodeAt(i)^Y.charCodeAt(i%r);n+=String.fromCharCode(o)}return btoa(unescape(encodeURIComponent(n)))}catch(e){return null}}const d=f.debug?(...t)=>console.log("[Skopos]",...t):()=>{},_=(...t)=>console.warn("[Skopos]",...t);function X(){try{const t=new Uint8Array(16);return(a.crypto||a.msCrypto).getRandomValues(t),Array.from(t,e=>e.toString(16).padStart(2,"0")).join("").slice(0,24)}catch(t){let e="";for(let r=0;r<24;r++)e+=Math.floor(Math.random()*16).toString(16);return e}}function P(t){try{return localStorage.getItem(t)}catch(e){return null}}function z(t,e){try{return localStorage.setItem(t,e),!0}catch(r){return!1}}function H(t){try{return localStorage.removeItem(t),!0}catch(e){return!1}}function Z(t){try{return sessionStorage.getItem(t)}catch(e){return null}}function tt(t,e){try{return sessionStorage.setItem(t,e),!0}catch(r){return!1}}function mt(){let t=P(W);return(!t||typeof t!="string"||t.length<16)&&(t=X(),z(W,t)),t}function et(){const t=Date.now();let e=Z(J);const r=Number.parseInt(Z(w),10)||0;return(!e||typeof e!="string"||e.length<16||r>0&&t-r>f.sessionTimeout)&&(e=X(),tt(J,e)),tt(w,String(t)),e}function h(t,e=2048){if(t==null)return"";let r=t;if(typeof r!="string")try{r=String(r)}catch(i){return""}let n="";for(let i=0;i<r.length;i++){const o=r.charCodeAt(i);(o>=32&&o<127||o>159)&&(n+=r[i])}return n.trim().slice(0,e)}function O(t,e=5,r=0){if(r>=e||t==null)return null;if(typeof t=="string")return h(t,1024);if(typeof t=="number")return Number.isFinite(t)?t:null;if(typeof t=="boolean")return t;if(Array.isArray(t))return t.slice(0,100).map(n=>O(n,e,r+1)).filter(n=>n!=null);if(typeof t=="object"){const n={},i=Object.keys(t).slice(0,50);for(const o of i){const u=h(o,128);if(u){const l=O(t[o],e,r+1);l!=null&&(n[u]=l)}}return n}return null}function q(t){if(typeof t!="string")return null;try{const e=JSON.parse(t);return e&&typeof e=="object"?e:null}catch(e){return null}}function yt(t){if(!t||typeof t!="string")return!1;try{return new URL(t,y.href).hostname.toLowerCase()!==y.hostname.toLowerCase()}catch(e){return!1}}function bt(t){if(!t||typeof t!="string")return!1;try{const e=new URL(t,y.href).pathname;return G.test(e)}catch(e){return G.test(t)}}function kt(){return f.hashMode?y.hash.slice(1)||"/":y.pathname+y.search}function vt(){return y.href}function Et(){const t=p.userAgent;return!!(!t||typeof t!="string"||/bot|crawl|spider|scrape|headless|phantom|selenium|puppeteer|playwright|prerender|lighthouse/i.test(t)||p.webdriver===!0||a._phantom||a.__nightmare||a.callPhantom)}const s={visitorId:mt(),sessionId:et(),lastPath:null,pageEntryTime:Date.now(),totalActiveTime:0,lastActiveTime:Date.now(),isVisible:!c.hidden,hasTrackedExit:!1,eventQueue:[],errorQueue:new Map,flushTimer:null,errorFlushTimer:null,initialized:!1,identifiedUser:null,isFlushing:!1,breadcrumbs:[]};function T(t,e,r={}){const n={t,m:h(e,256),ts:Date.now()};if(r&&typeof r=="object"&&Object.keys(r).length>0){const i=O(r,3);i&&Object.keys(i).length>0&&(n.d=i)}for(s.breadcrumbs.push(n);s.breadcrumbs.length>pt;)s.breadcrumbs.shift();d("Breadcrumb:",t,e)}function St(){return s.breadcrumbs.slice()}function rt(t){var o;if(!t||t===c.body||t===c.documentElement)return"body";const e=[];let r=t,n=0;const i=5;for(;r&&r!==c.body&&n<i;){let u=((o=r.tagName)==null?void 0:o.toLowerCase())||"";if(r.id){u+=`#${r.id}`,e.unshift(u);break}if(r.className&&typeof r.className=="string"){const l=r.className.trim().split(/\s+/).filter(m=>m&&!/^(ng-|_|js-)/.test(m)).slice(0,2);l.length>0&&(u+=`.${l.join(".")}`)}e.unshift(u),r=r.parentElement,n++}return e.join(" > ").slice(0,128)||"unknown"}function Tt(t){if(!t)return"";const e=t.getAttribute("aria-label")||t.getAttribute("title")||t.innerText||t.value||t.getAttribute("placeholder")||"";return h(e,50).replace(/\s+/g," ").trim()}function C(){var t,e;return{sid:f.siteId,vid:s.visitorId,ssid:s.sessionId,url:h(vt(),4096),ref:h(c.referrer,2048),sw:((t=a.screen)==null?void 0:t.width)||0,sh:((e=a.screen)==null?void 0:e.height)||0,vw:a.innerWidth||0,vh:a.innerHeight||0,lang:(p.language||"").slice(0,10),tz:(()=>{try{return Intl.DateTimeFormat().resolvedOptions().timeZone||""}catch(r){return""}})(),ts:Date.now()}}function A(t,e=!1){if(!t)return!1;let r;try{const n=gt(t);if(!n)return d("Failed to obfuscate payload"),!1;r=JSON.stringify({_d:n,_v:1})}catch(n){return d("Failed to serialize payload:",n),!1}if(d("Sending:",t),e&&p.sendBeacon)try{const n=new Blob([r],{type:"application/json"});if(p.sendBeacon(K,n))return!0}catch(n){d("sendBeacon failed:",n)}try{return fetch(K,{method:"POST",headers:{"Content-Type":"application/json"},body:r,keepalive:!0,mode:"cors",credentials:"omit"}).catch(n=>{d("Fetch failed:",n),nt(t)}),!0}catch(n){return d("Request failed:",n),nt(t),!1}}function nt(t){try{const e=q(P(F))||[];if(!Array.isArray(e))return;for(e.push(t);e.length>ht;)e.shift();z(F,JSON.stringify(e))}catch(e){d("Failed to store request:",e)}}function At(){try{const t=q(P(F));if(!Array.isArray(t)||t.length===0)return;H(F);for(const e of t)e&&typeof e=="object"&&A(e)}catch(t){d("Failed to retry requests:",t)}}function R(t){t&&(s.eventQueue.push(t),s.eventQueue.length>=f.maxBatchSize?$():s.flushTimer||(s.flushTimer=setTimeout($,f.batchInterval)))}function $(t=!1){if(s.flushTimer&&(clearTimeout(s.flushTimer),s.flushTimer=null),s.eventQueue.length===0||s.isFlushing)return;s.isFlushing=!0;const e=s.eventQueue.slice();s.eventQueue.length=0,s.isFlushing=!1;const r=I(E({},C()),{type:"batch",events:e});A(r,t)}function st(){if(s.isVisible){const t=Date.now(),e=t-s.lastActiveTime;e>0&&e<f.sessionTimeout&&(s.totalActiveTime+=e),s.lastActiveTime=t}}function Nt(){st();const t=Math.round(s.totalActiveTime/1e3);return Math.max(0,Math.min(t,86400))}function D(){s.pageEntryTime=Date.now(),s.totalActiveTime=0,s.lastActiveTime=Date.now(),s.isVisible=!c.hidden,s.hasTrackedExit=!1}function k(t=!1){const e=kt();if(e===s.lastPath)return;const r=s.lastPath;s.lastPath=e,s.sessionId=et(),T(S.NAVIGATION,`Navigated to ${e}`,{from:r||"(initial)",to:e});const n={t:"pv",p:h(e,2048)};if(t||!s.initialized){const i=I(E({},C()),{type:"batch",events:[n]});A(i)}else R(n);d("Page view:",e)}function it(t,e={}){if(!t||typeof t!="string"){_("Event name must be a non-empty string");return}T(S.CUSTOM,`Event: ${t}`,e);const r={t:"ev",n:h(t,255)};if(e&&typeof e=="object"&&!Array.isArray(e)){const n=O(e);if(n)try{JSON.stringify(n).length<=8192&&(r.d=n)}catch(i){_("Invalid event data")}}R(r),d("Event:",t,e)}function L(t="leave"){if(s.hasTrackedExit)return;s.hasTrackedExit=!0;const e=Nt();if(e<1)return;$(!0);const r=I(E({},C()),{type:"exit",dur:e,reason:h(t,32)});A(r,!0),d("Page exit:",t,`${e}s`)}function B(t,e,r,n,i){if(!f.trackErrors)return;const o=h(t||"Unknown error",512),u=h(e||"",4096),l=u.split(`
`)[1]||"",m=`${o}|${l}`,v=s.errorQueue.get(m);if(v){v.count=Math.min(v.count+1,1e4);return}s.errorQueue.size>=dt&&x();const N=St();s.errorQueue.set(m,{msg:o,stack:u,src:h(r||"",512),line:typeof n=="number"&&Number.isFinite(n)?n:0,col:typeof i=="number"&&Number.isFinite(i)?i:0,count:1,bc:N}),s.errorFlushTimer||(s.errorFlushTimer=setTimeout(x,1e4)),d("Error tracked:",t,"with",N.length,"breadcrumbs")}function x(t=!1){if(s.errorFlushTimer&&(clearTimeout(s.errorFlushTimer),s.errorFlushTimer=null),s.errorQueue.size===0)return;const e=Array.from(s.errorQueue.values());s.errorQueue.clear();const r=I(E({},C()),{type:"errors",errors:e});A(r,t)}function It(t){!f.trackOutbound||!t||(R({t:"out",u:h(t,2048)}),d("Outbound:",t))}function Ot(t){var r;if(!f.trackDownloads||!t)return;let e="";try{e=new URL(t,y.href).pathname.split("/").pop()||""}catch(n){e=((r=t.split("/").pop())==null?void 0:r.split("?")[0])||""}R({t:"dl",f:h(e,255),u:h(t,2048)}),d("Download:",e)}function Ct(t,e={}){if(!t||typeof t!="string"){_("User ID must be a non-empty string");return}s.identifiedUser={id:h(t,255)};const r={uid:s.identifiedUser.id};if(e&&typeof e=="object"&&(e.name&&(r.name=h(e.name,255)),e.email&&(r.email=h(e.email,255)),e.phone&&(r.phone=h(e.phone,50)),e.metadata&&typeof e.metadata=="object")){const i=O(e.metadata);if(i)try{JSON.stringify(i).length<=4096&&(r.meta=i)}catch(o){d("Invalid metadata:",o)}}const n=E(I(E({},C()),{type:"identify"}),r);A(n),d("Identify:",t,e)}function j(t){if(!t||!t.querySelectorAll)return;let e;try{e=t.querySelectorAll("[skopos-event]:not([skopos-bound])")}catch(r){return}for(const r of e){const n=r.getAttribute("skopos-event");if(!n)continue;const i=r.getAttribute("skopos-event-on")||"click";r.addEventListener(i,()=>{let o={};const u=r.getAttribute("skopos-data");if(u){const m=q(u);m&&!Array.isArray(m)&&(o=m)}const l=r.getAttribute("skopos-data-from");if(l){const m=l.split(",");for(const v of m){const N=v.indexOf(":");if(N===-1)continue;const ut=v.slice(0,N).trim(),Q=v.slice(N+1).trim();if(ut&&Q)try{const U=c.querySelector(Q);if(U){const Ft="value"in U?U.value:U.textContent;o[ut]=(Ft||"").trim()}}catch(U){d("Invalid selector:",Q)}}}it(n,o)}),r.setAttribute("skopos-bound","true")}}function Lt(t){if(!t||!t.target)return;const e=t.target.closest?t.target.closest("a[href]"):null;if(!e)return;const r=e.getAttribute("href");if(!r||r.startsWith("#")||r.startsWith("javascript:")||r.startsWith("mailto:")||r.startsWith("tel:"))return;let n;try{n=new URL(r,y.href).href}catch(i){return}bt(n)?Ot(n):yt(n)&&It(n)}function xt(t){var i;if(!t||!t.target)return;const e=t.target.closest?t.target.closest("button, a, input[type=submit], input[type=button], [role=button], [onclick]"):t.target;if(!e)return;const r=rt(e),n=Tt(e);T(S.CLICK,n?`Clicked "${n}"`:`Clicked ${r}`,{selector:r,tag:(i=e.tagName)==null?void 0:i.toLowerCase()})}function Ut(t){if(!t||!t.target)return;const e=t.target;if(!e.tagName||!["INPUT","TEXTAREA","SELECT"].includes(e.tagName))return;const r=e.type||"text";if(r==="password")return;const n=rt(e),i=e.name||e.id||e.placeholder||r;T(S.INPUT,`Input on ${i}`,{selector:n,type:r})}function ot(t,...e){if(typeof t=="string")switch(t){case"event":it(e[0],e[1]);break;case"pageview":k();break;case"identify":Ct(e[0],e[1]);break;case"opt-out":z(`${b}optout`,"1"),a.skopos=()=>{};break;case"opt-in":H(`${b}optout`);try{y.reload()}catch(r){}break;case"debug":f.debug=e[0]!==!1;break;default:_("Unknown command:",t)}}function at(){var r;if(s.initialized)return;if(P(`${b}optout`)==="1"){d("User opted out"),a.skopos=()=>{};return}if(Et()){d("Bot detected, skipping"),a.skopos=()=>{};return}s.initialized=!0;const t=((r=a.skopos)==null?void 0:r.q)||[];if(a.skopos=ot,At(),f.autoTrack){c.readyState==="complete"?k(!0):a.addEventListener("load",()=>k(!0),{once:!0});const n=M.pushState;M.pushState=function(...o){L("navigate");const u=n.apply(this,o);return D(),setTimeout(k,0),u};const i=M.replaceState;M.replaceState=function(...o){const u=i.apply(this,o);return setTimeout(k,0),u},a.addEventListener("popstate",()=>{L("navigate"),D(),k()}),f.hashMode&&a.addEventListener("hashchange",()=>{L("navigate"),D(),k()})}if(c.addEventListener("visibilitychange",()=>{c.hidden?(st(),s.isVisible=!1,$(!0),x(!0)):(s.isVisible=!0,s.lastActiveTime=Date.now())}),a.addEventListener("pagehide",()=>{L("leave"),x(!0)}),a.addEventListener("beforeunload",()=>{L("leave"),x(!0)}),f.trackErrors&&(a.addEventListener("error",n=>{var i,o;if(n instanceof ErrorEvent){const u=n.message||((i=n.error)==null?void 0:i.message)||"Unknown error",l=((o=n.error)==null?void 0:o.stack)||"";B(u,l,n.filename,n.lineno,n.colno)}else if(n.target&&(n.target.tagName==="SCRIPT"||n.target.tagName==="LINK"||n.target.tagName==="IMG")){const u=n.target.src||n.target.href||"unknown";B(`Failed to load ${n.target.tagName.toLowerCase()}: ${u}`,"",u,0,0)}},!0),a.addEventListener("unhandledrejection",n=>{const i=n==null?void 0:n.reason;let o,u;i instanceof Error?(o=i.message||"Unhandled promise rejection",u=i.stack||""):(o=i!=null?String(i):"Unhandled promise rejection",u=""),B(o,u)})),(f.trackOutbound||f.trackDownloads)&&c.addEventListener("click",Lt,!0),f.trackErrors){c.addEventListener("click",xt,!0),c.addEventListener("change",Ut,!0);const n=console.error;console.error=(...o)=>{const u=o.map(l=>typeof l=="object"?JSON.stringify(l):String(l)).join(" ");return T(S.CONSOLE,`console.error: ${u.slice(0,200)}`),n.apply(console,o)};const i=console.warn;console.warn=(...o)=>{const u=o.map(l=>typeof l=="object"?JSON.stringify(l):String(l)).join(" ");return T(S.CONSOLE,`console.warn: ${u.slice(0,200)}`),i.apply(console,o)}}const e=()=>{c.body&&j(c.body)};c.readyState==="loading"?c.addEventListener("DOMContentLoaded",e):e(),typeof MutationObserver=="function"&&c.body&&new MutationObserver(i=>{var o;for(const u of i)if(u.addedNodes){for(const l of u.addedNodes)if(l.nodeType===Node.ELEMENT_NODE){if((o=l.hasAttribute)!=null&&o.call(l,"skopos-event"))j(l.parentElement||c.body);else if(l.querySelector)try{l.querySelector("[skopos-event]")&&j(l)}catch(m){}}}}).observe(c.body,{childList:!0,subtree:!0});for(const n of t)Array.isArray(n)&&ot(...n);d("Initialized with config:",f)}const Mt=((ct=a.skopos)==null?void 0:ct.q)||[];a.skopos=(...t)=>{a.skopos.q=a.skopos.q||[],a.skopos.q.push(t)},a.skopos.q=Mt,c.readyState==="loading"?c.addEventListener("DOMContentLoaded",at,{once:!0}):at()})(window,document,navigator,location,history);
